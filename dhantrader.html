<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Place Order Form</title>
</head>
<body>
    <h2>Place Order Form</h2>
    
    <form id="orderForm">
        <label for="security_id">Security ID:</label>
<div id="json"></div></br></br>
        
        
        <label for="exchange_segment">Exchange Segment:</label>
        <select id="exchange_segment" name="exchange_segment">
            
            <option value="MCX">MCX</option>
            
        </select><br><br>

        <label for="transaction_type">Transaction Type:</label>
        <select id="transaction_type" name="transaction_type">
            <option value="BUY">BUY</option>
            <option value="SELL">SELL</option>
        </select><br><br>

        <label for="quantity">Quantity:</label>
        <input type="number" id="quantity" name="quantity" required><br><br>

        <label for="order_type">Order Type:</label>
        <select id="order_type" name="order_type">
            <option value="MARKET">MARKET</option>
            <option value="LIMIT">LIMIT</option>
        </select><br><br>

        <label for="product_type">Product Type:</label>
        <select id="product_type" name="product_type">
            <option value="INTRA">INTRA</option>
            <option value="DELIVERY">DELIVERY</option>
        </select><br><br>

        <label for="price">Price:</label>
        <input type="number" id="price" name="price" step="0.01" value="0"><br><br>

        <button type="button" onclick="createOrder()">Create Order</button>
    </form>

    <h3>Order Output</h3>
    <textarea id="output" rows="10" cols="50"></textarea>

    <script>


        
        function createOrder() {
            const security_id = document.getElementById('security_id').value;
            const exchange_segment = document.getElementById('exchange_segment').value;
            const transaction_type = document.getElementById('transaction_type').value;
            const quantity = document.getElementById('quantity').value;
            const order_type = document.getElementById('order_type').value;
            const product_type = document.getElementById('product_type').value;
            const price = document.getElementById('price').value;

            const orderOutput = `dhan.place_order(security_id='${security_id}', 
    exchange_segment=dhan.${exchange_segment},
    transaction_type=dhan.${transaction_type},
    quantity=${quantity},
    order_type=dhan.${order_type},
    product_type=dhan.${product_type},
    price=${price})`;

            document.getElementById('output').value = orderOutput;
        }
        
//https://docs.google.com/spreadsheets/d//edit?gid=1262794092#gid=1262794092//
var id='1gNqdRC3Ars9Z8qhQHtiJ9FiVExcsIt8Gfn9SNRGFm_o';
var gid = '1262794092';
var source='O1:O1';
var url = 'https://docs.google.com/spreadsheets/d/'+id+'/gviz/tq?tqx=out:json&tq&gid='+gid+'&single=true&range='+source;
fetch(url)
  .then(response => response.text())
  .then(data => document.getElementById("json").innerHTML=myItems(data.slice(47, -2))  
  );
function myItems(jsonString){
  var json = JSON.parse(jsonString);
  var table = ""
 json.table.cols.forEach(colonne => table += '' + colonne.label + "")
  table += ''
  json.table.rows.forEach(ligne => {
    table += ''
    ligne.c.forEach(cellule => {
        try{var valeur = cellule.f ? cellule.f : cellule.v}
        catch(e){var valeur = ''}
        table += "" + valeur + ""
      }
    )
    table += ''
    }
  )
  table += ''
  return table
}

        
    </script>
</body>
</html>
